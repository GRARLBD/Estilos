<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="estilos.css"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <title>Weapon system</title>
  </head>
  <center>
    <body style="background-color: #800000">
      <div class="container-fluid">
        <!-- Primera fila -->
        <div class="row" style="height: 25vh">
          <div class="col-md-12">
            <br />
            <p
              class="text-left mt-3 mb-3 fw-bold fs-1 text-colegio"
              style="margin-left: 25px"
            >
              Arnés Táctico Inteligente
            </p>
          </div>
        </div>
        <!-- Segunda fila -->
        <div class="row" style="height: 75vh">
          <div class="col-md-12 bg-primary">
            <div
              id="caja"
              style="width: 40%"
              class="h-100 imgBackground caja"
            ></div>
          </div>
        </div>
      </div>

      <script src="acciones.js">
        var gateway = `ws://${window.location.hostname}/ws`;
var websocket;
window.addEventListener('load', onLoad);
function initWebSocket() {
    console.log('Trying to open a WebSocket connection...');
    websocket = new WebSocket(gateway);
    websocket.onopen = onOpen;
    websocket.onclose = onClose;
    websocket.onmessage = onMessage; // <-- add this line
}
function onOpen(event) {
    console.log('Connection opened');
}
function onClose(event) {
    console.log('Connection closed');
    setTimeout(initWebSocket, 2000);
}
function onMessage(event) {
    var state;
    //var index = parseInt(event.data );
    //dibujar(index);
    if (event.data == "1") {
        state = "ON";
    }
    else {
        state = "OFF";
    }
    //document.getElementById('state').innerHTML = state;
}
function onLoad(event) {
    initWebSocket();
    initButton();
    dibujar(-1);
}
function initButton() {
    // document.getElementById('button').addEventListener('click', toggle);
}
function toggle() {
    //websocket.send('toggle');
}

function dibujar() {
var selectedCirculo = 3;
    var caja = document.getElementById("caja");
    var x = "39%";
    var y = "22%";
    var espaciado = "6%";
    var salto = 0;
    var limite = 4;
    var index = 0;

    for (var i = 0; i < limite; i++, salto++) {
        index += 1;
        var circulo = document.createElement("div");
        circulo.classList.add("circulo");
        circulo.id = "circulo" + (i + 1);
        var posicionX = "calc(" + x + " + (" + salto + " * " + espaciado + "))";
        circulo.style.top = y;
        circulo.style.left = posicionX;
        caja.appendChild(circulo);

        if (index === selectedCirculo) {
            selectedCirculo = circulo;
            selectedCirculo.style.backgroundColor = "green";
        }

    }

    x = "48%";
    y = "31%";
    espaciado = "6%";
    var salto = 0;
    var limite = 1;

    for (var i = 0; i < limite; i++, salto++) {
        index += 1;
        var circulo = document.createElement("div");
        circulo.classList.add("circulo");
        circulo.id = "circulo" + (index);
        var posicionX = "calc(" + x + " + (" + salto + " * " + espaciado + "))";
        circulo.style.top = y;
        circulo.style.left = posicionX;

        caja.appendChild(circulo);
        if (index === selectedCirculo) {
            selectedCirculo = circulo;
            selectedCirculo.style.backgroundColor = "green"; // Cambiar el color del círculo resaltado a verde
        }
    }


    x = "48%";
    y = "41%";
    espaciado = "6%";
    var salto = 0;
    var limite = 1;

    for (var i = 0; i < limite; i++, salto++) {
        index += 1;
        var circulo = document.createElement("div");
        circulo.classList.add("circulo");
        circulo.id = "circulo" + (i + 1);
        var posicionX = "calc(" + x + " + (" + salto + " * " + espaciado + "))";

        circulo.style.top = y;
        circulo.style.left = posicionX;
        caja.appendChild(circulo);
        if (index === selectedCirculo) {
            selectedCirculo = circulo;
            selectedCirculo.style.backgroundColor = "green"; // Cambiar el color del círculo resaltado a verde
        }
    }
}

      </script>
    </body>
  </center>
</html>
